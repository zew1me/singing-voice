# Repository Guidelines

## Project Structure & Module Organization
- `src/singing_voice/`: core Python package with CLI (`cli.py`), preprocessing (`preprocess.py`), stitching (`stitch.py`), manifest helpers, and RunPod submission utilities. Keep new modules within this package to ensure Typer entry points stay discoverable.
- `runpod_worker/`: GPU-only Seed-VC worker code. Mirror JSON contracts from `singing_voice.manifests` when adding RunPod endpoints.
- `working/`: scratch space for manifests/audio generated by `svtool`. Never commit outputsâ€”add new temp directories under `working/<session_timestamp>/`.
- `pyproject.toml`: single source of dependency truth. Update optional extras instead of ad-hoc requirements files.

## Build, Test, and Development Commands
- `uv venv && source .venv/bin/activate`: create/activate the local virtualenv.
- `uv pip install -e .[runpod]`: install the editable package plus optional HTTP client deps.
- `svtool preprocess input.wav --workdir working`: run Step A locally; outputs manifest JSON.
- `svtool submit-runpod manifest.json --endpoint <url>`: send Step A output to a RunPod serverless endpoint.
- `svtool stitch converted_manifest.json --output working/final.wav`: run Step C locally.

## Coding Style & Naming Conventions
- Python 3.10+, follow PEP 8 (4-space indent, snake_case functions). Prefer dataclasses for config payloads and keep new manifests in `manifests.py`.
- All CLI options should expose explicit units (e.g., `--chunk-seconds`). Keep generated files out of repo by defaulting to `working/`.

## Testing Guidelines
- No formal test suite yet. When adding tests, colocate under `tests/` and target pure helpers (e.g., silence detection, crossfade logic).
- Use pytest naming (`test_<module>.py`) and keep fixtures deterministic by seeding NumPy.

## Commit & Pull Request Guidelines
- Commit messages: short imperative summary (`Add stitch crossfade control`). Reference issue IDs when applicable.
- Pull requests should describe the affected pipeline step (A/B/C), list new commands or flags, and mention manual verification (e.g., sample WAV run). Include before/after audio artifacts via external links when relevant.
